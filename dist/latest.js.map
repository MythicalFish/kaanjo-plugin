{"version":3,"sources":["detect-browser.js","plugin.js","websocket_rails.0.0.1.min.js","latest.js","js.cookie.js"],"names":["detectBrowser","userAgentString","createMatch","pair","concat","exec","isMatch","browsers","i","mapped","length","push","match","parts","split","slice","name","version","join","cl","msg","console","log","__bind","fn","me","apply","arguments","this","WebSocketRails","url","use_websockets","connection_stale","pong","supports_websockets","dispatch_channel","unsubscribe","subscribe_private","subscribe","dispatch","trigger_event","trigger","unbind","bind","connection_established","new_message","reconnect","callbacks","channels","queue","connect","prototype","state","_conn","WebSocketConnection","HttpConnection","disconnect","close","event","id","old_connection_id","_ref","_ref1","connection_id","is_result","reconnect_channels","data","socket_message","_i","_len","_results","Event","run_callbacks","success","is_channel","is_ping","setConnectionId","flush_queue","on_open","event_name","callback","_base","success_callback","failure_callback","_name","channel_name","channel","Channel","destroy","WebSocket","_callbacks","is_private","call","attr","Math","random","token","result","serialize","JSON","stringify","attributes","AbstractConnection","dispatcher","message_queue","send_event","on_close","close_event","on_error","error_event","on_message","event_data","__hasProp","hasOwnProperty","__extends","child","parent","ctor","constructor","key","__super__","_super","window","location","protocol","onmessage","_this","parse","onclose","onerror","connection_type","send","_dispatcher","on_success","on_failure","_failure_launcher","_success_launcher","_token","_queue","message","_typeof","Symbol","iterator","obj","factory","define","amd","exports","module","OldCookies","Cookies","api","noConflict","extend","init","converter","value","document","path","defaults","expires","Date","setMilliseconds","getMilliseconds","test","e","write","encodeURIComponent","String","replace","decodeURIComponent","escape","cookie","toUTCString","domain","secure","cookies","rdecode","charAt","read","json","set","get","getJSON","remove","withConverter","addEventListener","Kaanjo","socket","setTimeout","hook","getElementById","valid","attribute","getAttribute","webmaster","customer","product","request","device","navigator","userAgent","get_html","cb","fail","params","sid","href","html","innerHTML","action","react","reaction_id","is_valid","hasAttribute","error"],"mappings":"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","file":"latest.js","sourcesContent":["function detectBrowser(userAgentString) {\n  var browsers = [\n    [ 'edge', /Edge\\/([0-9\\._]+)/ ],\n    [ 'chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/ ],\n    [ 'firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/ ],\n    [ 'opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/ ],\n    [ 'opera', /OPR\\/([0-9\\.]+)(:?\\s|$)$/ ],\n    [ 'ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+)\\).*Gecko$/ ],\n    [ 'ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/ ],\n    [ 'ie', /MSIE\\s(7\\.0)/ ],\n    [ 'bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/ ],\n    [ 'android', /Android\\s([0-9\\.]+)/ ],\n    [ 'ios', /iPad.*Version\\/([0-9\\._]+)/ ],\n    [ 'ios',  /iPhone.*Version\\/([0-9\\._]+)/ ],\n    [ 'safari', /Version\\/([0-9\\._]+).*Safari/ ]\n  ];\n\n  var i = 0, mapped =[];\n  for (i = 0; i < browsers.length; i++) {\n    browsers[i] = createMatch(browsers[i]);\n    if (isMatch(browsers[i])) {\n      mapped.push(browsers[i]);\n    }\n  }\n\n  var match = mapped[0];\n  var parts = match && match[3].split(/[._]/).slice(0,3);\n\n  while (parts && parts.length < 3) {\n    parts.push('0');\n  }\n\n  function createMatch(pair) {\n    return pair.concat(pair[1].exec(userAgentString));\n  }\n\n  function isMatch(pair) {\n    return !!pair[2];\n  }\n\n  // return the name and version\n  return {\n    name: match && match[0],\n    version: parts && parts.join('.'),\n  };\n};\n","document.addEventListener(\"DOMContentLoaded\", () => { \n  \n  Kaanjo.socket.on_open = function(data) {\n    console.log(`Connection established: ${data.connection_id}`)\n    setTimeout(() => { \n      Kaanjo.init()\n    },500);\n  }\n\n});\n\nconst Kaanjo = {\n\n  init() {\n    \n    Kaanjo.hook = document.getElementById(\"kaanjo\");\n\n    if(!Kaanjo.valid(Kaanjo.hook))\n      return false\n\n    for(const attribute in Kaanjo.attributes) {\n      Kaanjo.attributes[attribute] = Kaanjo.hook.getAttribute(`data-${attribute}`);\n    }\n\n    Kaanjo.webmaster.init(() => {\n      Kaanjo.customer.init(() => {\n        Kaanjo.product.init(() => {\n          Kaanjo.request('customer.impress', {\n            device: detectBrowser(navigator.userAgent).name\n          },(success) => {\n            console.log(success.msg)\n            Kaanjo.get_html()\n          })\n        })\n      })\n    })\n    \n\n  },\n\n  webmaster: {\n    init(cb) {\n      Kaanjo.request( 'webmaster.find', \n        {\n          key: Kaanjo.attributes['key']\n        }, \n        (success) => { \n          console.log(success.msg)\n          cb();\n        }, \n        (fail) => { console.log(fail.msg); }\n      );\n    }\n  },\n\n  customer: {\n    init(cb) {\n      \n      params = { id: null }\n\n      Kaanjo.customer.id = Kaanjo.cookies.get('kaanjo_cid')\n      if(Kaanjo.customer.id) {\n        params.id = Kaanjo.customer.id\n      }\n\n      Kaanjo.request( 'customer.find', params,\n      (success) => {\n        Kaanjo.cookies.set('kaanjo_cid', success.sid);\n        Kaanjo.customer.id = success.sid;\n        console.log(success.msg)\n        cb()\n      },\n      (fail) => {\n        console.log(fail.msg)\n      })\n\n    }\n  },\n\n  product: {\n    init(cb) {\n      Kaanjo.request( 'product.find', {\n        product: Kaanjo.attributes.product,\n        url: window.location.href\n      }, \n      (success) => {\n        Kaanjo.product.data = success.data\n        console.log(success.msg)\n        cb();\n      }, \n      (fail) => { \n        console.log(fail.msg) \n      })\n    }\n  },\n\n  get_html() {\n    Kaanjo.request('product.get_html',{},\n    (html) => {\n      Kaanjo.hook.innerHTML = html.msg\n    })\n  },\n\n  cookies: Cookies.noConflict(),\n\n  //socket: new WebSocketRails('localhost:3000/websocket'),\n  socket: new WebSocketRails('kaanjo.co/websocket'),\n\n  request(action,data,success,fail) {\n    Kaanjo.socket.trigger(action,data,success,fail)\n  },\n\n  react(reaction_id) {\n    Kaanjo.request('customer.react',{\n      id: reaction_id\n    })\n  },\n\n  valid(hook) {\n\n    let is_valid = true;\n\n    if(hook == null) {\n      is_valid = false;\n\n    } else {\n\n      for(const attribute in Kaanjo.attributes) {\n\n        if(!hook.hasAttribute(`data-${attribute}`)) {\n          console.error(`Kaanjo: You are missing the '${attribute}' attribute in your HTML.`)\n          is_valid = false;\n        } \n\n      }\n    }\n\n    return is_valid;\n\n  },\n\n  attributes: {\n    key: null,\n    product: null\n  }\n\n}\n\nfunction cl(msg) {\n  console.log(msg)\n}\n","(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};this.WebSocketRails=function(){function WebSocketRails(url,use_websockets){this.url=url,this.use_websockets=null!=use_websockets?use_websockets:!0,this.connection_stale=__bind(this.connection_stale,this),this.pong=__bind(this.pong,this),this.supports_websockets=__bind(this.supports_websockets,this),this.dispatch_channel=__bind(this.dispatch_channel,this),this.unsubscribe=__bind(this.unsubscribe,this),this.subscribe_private=__bind(this.subscribe_private,this),this.subscribe=__bind(this.subscribe,this),this.dispatch=__bind(this.dispatch,this),this.trigger_event=__bind(this.trigger_event,this),this.trigger=__bind(this.trigger,this),this.unbind=__bind(this.unbind,this),this.bind=__bind(this.bind,this),this.connection_established=__bind(this.connection_established,this),this.new_message=__bind(this.new_message,this),this.reconnect=__bind(this.reconnect,this),this.callbacks={},this.channels={},this.queue={},this.connect()}return WebSocketRails.prototype.connect=function(){return this.state=\"connecting\",this._conn=this.supports_websockets()&&this.use_websockets?new WebSocketRails.WebSocketConnection(this.url,this):new WebSocketRails.HttpConnection(this.url,this),this._conn.new_message=this.new_message},WebSocketRails.prototype.disconnect=function(){return this._conn&&(this._conn.close(),delete this._conn._conn,delete this._conn),this.state=\"disconnected\"},WebSocketRails.prototype.reconnect=function(){var event,id,old_connection_id,_ref,_ref1;old_connection_id=null!=(_ref=this._conn)?_ref.connection_id:void 0,this.disconnect(),this.connect(),_ref1=this.queue;for(id in _ref1)event=_ref1[id],event.connection_id!==old_connection_id||event.is_result()||this.trigger_event(event);return this.reconnect_channels()},WebSocketRails.prototype.new_message=function(data){var event,socket_message,_i,_len,_ref,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)socket_message=data[_i],event=new WebSocketRails.Event(socket_message),event.is_result()?(null!=(_ref=this.queue[event.id])&&_ref.run_callbacks(event.success,event.data),delete this.queue[event.id]):event.is_channel()?this.dispatch_channel(event):event.is_ping()?this.pong():this.dispatch(event),_results.push(\"connecting\"===this.state&&\"client_connected\"===event.name?this.connection_established(event.data):void 0);return _results},WebSocketRails.prototype.connection_established=function(data){return this.state=\"connected\",this._conn.setConnectionId(data.connection_id),this._conn.flush_queue(),null!=this.on_open?this.on_open(data):void 0},WebSocketRails.prototype.bind=function(event_name,callback){var _base;return null==(_base=this.callbacks)[event_name]&&(_base[event_name]=[]),this.callbacks[event_name].push(callback)},WebSocketRails.prototype.unbind=function(event_name){return delete this.callbacks[event_name]},WebSocketRails.prototype.trigger=function(event_name,data,success_callback,failure_callback){var event,_ref;return event=new WebSocketRails.Event([event_name,data,null!=(_ref=this._conn)?_ref.connection_id:void 0],success_callback,failure_callback),this.trigger_event(event)},WebSocketRails.prototype.trigger_event=function(event){var _base,_name;return null==(_base=this.queue)[_name=event.id]&&(_base[_name]=event),this._conn&&this._conn.trigger(event),event},WebSocketRails.prototype.dispatch=function(event){var callback,_i,_len,_ref,_results;if(null!=this.callbacks[event.name]){for(_ref=this.callbacks[event.name],_results=[],_i=0,_len=_ref.length;_len>_i;_i++)callback=_ref[_i],_results.push(callback(event.data));return _results}},WebSocketRails.prototype.subscribe=function(channel_name,success_callback,failure_callback){var channel;return null==this.channels[channel_name]?(channel=new WebSocketRails.Channel(channel_name,this,!1,success_callback,failure_callback),this.channels[channel_name]=channel,channel):this.channels[channel_name]},WebSocketRails.prototype.subscribe_private=function(channel_name,success_callback,failure_callback){var channel;return null==this.channels[channel_name]?(channel=new WebSocketRails.Channel(channel_name,this,!0,success_callback,failure_callback),this.channels[channel_name]=channel,channel):this.channels[channel_name]},WebSocketRails.prototype.unsubscribe=function(channel_name){return null!=this.channels[channel_name]?(this.channels[channel_name].destroy(),delete this.channels[channel_name]):void 0},WebSocketRails.prototype.dispatch_channel=function(event){return null!=this.channels[event.channel]?this.channels[event.channel].dispatch(event.name,event.data):void 0},WebSocketRails.prototype.supports_websockets=function(){return\"function\"==typeof WebSocket||\"object\"==typeof WebSocket},WebSocketRails.prototype.pong=function(){var pong,_ref;return pong=new WebSocketRails.Event([\"websocket_rails.pong\",{},null!=(_ref=this._conn)?_ref.connection_id:void 0]),this._conn.trigger(pong)},WebSocketRails.prototype.connection_stale=function(){return\"connected\"!==this.state},WebSocketRails.prototype.reconnect_channels=function(){var callbacks,channel,name,_ref,_results;_ref=this.channels,_results=[];for(name in _ref)channel=_ref[name],callbacks=channel._callbacks,channel.destroy(),delete this.channels[name],channel=channel.is_private?this.subscribe_private(name):this.subscribe(name),channel._callbacks=callbacks,_results.push(channel);return _results},WebSocketRails}()}).call(this),function(){WebSocketRails.Event=function(){function Event(data,success_callback,failure_callback){var attr;this.success_callback=success_callback,this.failure_callback=failure_callback,this.name=data[0],attr=data[1],null!=attr&&(this.id=null!=attr.id?attr.id:65536*(1+Math.random())|0,this.channel=null!=attr.channel?attr.channel:void 0,this.data=null!=attr.data?attr.data:attr,this.token=null!=attr.token?attr.token:void 0,this.connection_id=data[2],null!=attr.success&&(this.result=!0,this.success=attr.success))}return Event.prototype.is_channel=function(){return null!=this.channel},Event.prototype.is_result=function(){return\"undefined\"!=typeof this.result},Event.prototype.is_ping=function(){return\"websocket_rails.ping\"===this.name},Event.prototype.serialize=function(){return JSON.stringify([this.name,this.attributes()])},Event.prototype.attributes=function(){return{id:this.id,channel:this.channel,data:this.data,token:this.token}},Event.prototype.run_callbacks=function(success,result){return this.success=success,this.result=result,this.success===!0?\"function\"==typeof this.success_callback?this.success_callback(this.result):void 0:\"function\"==typeof this.failure_callback?this.failure_callback(this.result):void 0},Event}()}.call(this),function(){WebSocketRails.AbstractConnection=function(){function AbstractConnection(url,dispatcher){this.dispatcher=dispatcher,this.message_queue=[]}return AbstractConnection.prototype.close=function(){},AbstractConnection.prototype.trigger=function(event){return\"connected\"!==this.dispatcher.state?this.message_queue.push(event):this.send_event(event)},AbstractConnection.prototype.send_event=function(event){return null!=this.connection_id?event.connection_id=this.connection_id:void 0},AbstractConnection.prototype.on_close=function(event){var close_event;return this.dispatcher&&this.dispatcher._conn===this?(close_event=new WebSocketRails.Event([\"connection_closed\",event]),this.dispatcher.state=\"disconnected\",this.dispatcher.dispatch(close_event)):void 0},AbstractConnection.prototype.on_error=function(event){var error_event;return this.dispatcher&&this.dispatcher._conn===this?(error_event=new WebSocketRails.Event([\"connection_error\",event]),this.dispatcher.state=\"disconnected\",this.dispatcher.dispatch(error_event)):void 0},AbstractConnection.prototype.on_message=function(event_data){return this.dispatcher&&this.dispatcher._conn===this?this.dispatcher.new_message(event_data):void 0},AbstractConnection.prototype.setConnectionId=function(connection_id){this.connection_id=connection_id},AbstractConnection.prototype.flush_queue=function(){var event,_i,_len,_ref;for(_ref=this.message_queue,_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],this.trigger(event);return this.message_queue=[]},AbstractConnection}()}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};WebSocketRails.WebSocketConnection=function(_super){function WebSocketConnection(url,dispatcher){this.url=url,this.dispatcher=dispatcher,WebSocketConnection.__super__.constructor.apply(this,arguments),this.url.match(/^wss?:\\/\\//)?console.log(\"WARNING: Using connection urls with protocol specified is depricated\"):this.url=\"https:\"===window.location.protocol?\"wss://\"+this.url:\"ws://\"+this.url,this._conn=new WebSocket(this.url),this._conn.onmessage=function(_this){return function(event){var event_data;return event_data=JSON.parse(event.data),_this.on_message(event_data)}}(this),this._conn.onclose=function(_this){return function(event){return _this.on_close(event)}}(this),this._conn.onerror=function(_this){return function(event){return _this.on_error(event)}}(this)}return __extends(WebSocketConnection,_super),WebSocketConnection.prototype.connection_type=\"websocket\",WebSocketConnection.prototype.close=function(){return this._conn.close()},WebSocketConnection.prototype.send_event=function(event){return WebSocketConnection.__super__.send_event.apply(this,arguments),this._conn.send(event.serialize())},WebSocketConnection}(WebSocketRails.AbstractConnection)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};WebSocketRails.Channel=function(){function Channel(name,_dispatcher,is_private,on_success,on_failure){var event,event_name,_ref;this.name=name,this._dispatcher=_dispatcher,this.is_private=null!=is_private?is_private:!1,this.on_success=on_success,this.on_failure=on_failure,this._failure_launcher=__bind(this._failure_launcher,this),this._success_launcher=__bind(this._success_launcher,this),this._callbacks={},this._token=void 0,this._queue=[],event_name=this.is_private?\"websocket_rails.subscribe_private\":\"websocket_rails.subscribe\",this.connection_id=null!=(_ref=this._dispatcher._conn)?_ref.connection_id:void 0,event=new WebSocketRails.Event([event_name,{data:{channel:this.name}},this.connection_id],this._success_launcher,this._failure_launcher),this._dispatcher.trigger_event(event)}return Channel.prototype.destroy=function(){var event,event_name,_ref;return this.connection_id===(null!=(_ref=this._dispatcher._conn)?_ref.connection_id:void 0)&&(event_name=\"websocket_rails.unsubscribe\",event=new WebSocketRails.Event([event_name,{data:{channel:this.name}},this.connection_id]),this._dispatcher.trigger_event(event)),this._callbacks={}},Channel.prototype.bind=function(event_name,callback){var _base;return null==(_base=this._callbacks)[event_name]&&(_base[event_name]=[]),this._callbacks[event_name].push(callback)},Channel.prototype.unbind=function(event_name){return delete this._callbacks[event_name]},Channel.prototype.trigger=function(event_name,message){var event;return event=new WebSocketRails.Event([event_name,{channel:this.name,data:message,token:this._token},this.connection_id]),this._token?this._dispatcher.trigger_event(event):this._queue.push(event)},Channel.prototype.dispatch=function(event_name,message){var callback,_i,_len,_ref,_ref1,_results;if(\"websocket_rails.channel_token\"===event_name)return this.connection_id=null!=(_ref=this._dispatcher._conn)?_ref.connection_id:void 0,this._token=message.token,this.flush_queue();if(null!=this._callbacks[event_name]){for(_ref1=this._callbacks[event_name],_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)callback=_ref1[_i],_results.push(callback(message));return _results}},Channel.prototype._success_launcher=function(data){return null!=this.on_success?this.on_success(data):void 0},Channel.prototype._failure_launcher=function(data){return null!=this.on_failure?this.on_failure(data):void 0},Channel.prototype.flush_queue=function(){var event,_i,_len,_ref;for(_ref=this._queue,_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],this._dispatcher.trigger_event(event);return this._queue=[]},Channel}()}.call(this);","(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};this.WebSocketRails=function(){function WebSocketRails(url,use_websockets){this.url=url,this.use_websockets=null!=use_websockets?use_websockets:!0,this.connection_stale=__bind(this.connection_stale,this),this.pong=__bind(this.pong,this),this.supports_websockets=__bind(this.supports_websockets,this),this.dispatch_channel=__bind(this.dispatch_channel,this),this.unsubscribe=__bind(this.unsubscribe,this),this.subscribe_private=__bind(this.subscribe_private,this),this.subscribe=__bind(this.subscribe,this),this.dispatch=__bind(this.dispatch,this),this.trigger_event=__bind(this.trigger_event,this),this.trigger=__bind(this.trigger,this),this.unbind=__bind(this.unbind,this),this.bind=__bind(this.bind,this),this.connection_established=__bind(this.connection_established,this),this.new_message=__bind(this.new_message,this),this.reconnect=__bind(this.reconnect,this),this.callbacks={},this.channels={},this.queue={},this.connect()}return WebSocketRails.prototype.connect=function(){return this.state=\"connecting\",this._conn=this.supports_websockets()&&this.use_websockets?new WebSocketRails.WebSocketConnection(this.url,this):new WebSocketRails.HttpConnection(this.url,this),this._conn.new_message=this.new_message},WebSocketRails.prototype.disconnect=function(){return this._conn&&(this._conn.close(),delete this._conn._conn,delete this._conn),this.state=\"disconnected\"},WebSocketRails.prototype.reconnect=function(){var event,id,old_connection_id,_ref,_ref1;old_connection_id=null!=(_ref=this._conn)?_ref.connection_id:void 0,this.disconnect(),this.connect(),_ref1=this.queue;for(id in _ref1)event=_ref1[id],event.connection_id!==old_connection_id||event.is_result()||this.trigger_event(event);return this.reconnect_channels()},WebSocketRails.prototype.new_message=function(data){var event,socket_message,_i,_len,_ref,_results;for(_results=[],_i=0,_len=data.length;_len>_i;_i++)socket_message=data[_i],event=new WebSocketRails.Event(socket_message),event.is_result()?(null!=(_ref=this.queue[event.id])&&_ref.run_callbacks(event.success,event.data),delete this.queue[event.id]):event.is_channel()?this.dispatch_channel(event):event.is_ping()?this.pong():this.dispatch(event),_results.push(\"connecting\"===this.state&&\"client_connected\"===event.name?this.connection_established(event.data):void 0);return _results},WebSocketRails.prototype.connection_established=function(data){return this.state=\"connected\",this._conn.setConnectionId(data.connection_id),this._conn.flush_queue(),null!=this.on_open?this.on_open(data):void 0},WebSocketRails.prototype.bind=function(event_name,callback){var _base;return null==(_base=this.callbacks)[event_name]&&(_base[event_name]=[]),this.callbacks[event_name].push(callback)},WebSocketRails.prototype.unbind=function(event_name){return delete this.callbacks[event_name]},WebSocketRails.prototype.trigger=function(event_name,data,success_callback,failure_callback){var event,_ref;return event=new WebSocketRails.Event([event_name,data,null!=(_ref=this._conn)?_ref.connection_id:void 0],success_callback,failure_callback),this.trigger_event(event)},WebSocketRails.prototype.trigger_event=function(event){var _base,_name;return null==(_base=this.queue)[_name=event.id]&&(_base[_name]=event),this._conn&&this._conn.trigger(event),event},WebSocketRails.prototype.dispatch=function(event){var callback,_i,_len,_ref,_results;if(null!=this.callbacks[event.name]){for(_ref=this.callbacks[event.name],_results=[],_i=0,_len=_ref.length;_len>_i;_i++)callback=_ref[_i],_results.push(callback(event.data));return _results}},WebSocketRails.prototype.subscribe=function(channel_name,success_callback,failure_callback){var channel;return null==this.channels[channel_name]?(channel=new WebSocketRails.Channel(channel_name,this,!1,success_callback,failure_callback),this.channels[channel_name]=channel,channel):this.channels[channel_name]},WebSocketRails.prototype.subscribe_private=function(channel_name,success_callback,failure_callback){var channel;return null==this.channels[channel_name]?(channel=new WebSocketRails.Channel(channel_name,this,!0,success_callback,failure_callback),this.channels[channel_name]=channel,channel):this.channels[channel_name]},WebSocketRails.prototype.unsubscribe=function(channel_name){return null!=this.channels[channel_name]?(this.channels[channel_name].destroy(),delete this.channels[channel_name]):void 0},WebSocketRails.prototype.dispatch_channel=function(event){return null!=this.channels[event.channel]?this.channels[event.channel].dispatch(event.name,event.data):void 0},WebSocketRails.prototype.supports_websockets=function(){return\"function\"==typeof WebSocket||\"object\"==typeof WebSocket},WebSocketRails.prototype.pong=function(){var pong,_ref;return pong=new WebSocketRails.Event([\"websocket_rails.pong\",{},null!=(_ref=this._conn)?_ref.connection_id:void 0]),this._conn.trigger(pong)},WebSocketRails.prototype.connection_stale=function(){return\"connected\"!==this.state},WebSocketRails.prototype.reconnect_channels=function(){var callbacks,channel,name,_ref,_results;_ref=this.channels,_results=[];for(name in _ref)channel=_ref[name],callbacks=channel._callbacks,channel.destroy(),delete this.channels[name],channel=channel.is_private?this.subscribe_private(name):this.subscribe(name),channel._callbacks=callbacks,_results.push(channel);return _results},WebSocketRails}()}).call(this),function(){WebSocketRails.Event=function(){function Event(data,success_callback,failure_callback){var attr;this.success_callback=success_callback,this.failure_callback=failure_callback,this.name=data[0],attr=data[1],null!=attr&&(this.id=null!=attr.id?attr.id:65536*(1+Math.random())|0,this.channel=null!=attr.channel?attr.channel:void 0,this.data=null!=attr.data?attr.data:attr,this.token=null!=attr.token?attr.token:void 0,this.connection_id=data[2],null!=attr.success&&(this.result=!0,this.success=attr.success))}return Event.prototype.is_channel=function(){return null!=this.channel},Event.prototype.is_result=function(){return\"undefined\"!=typeof this.result},Event.prototype.is_ping=function(){return\"websocket_rails.ping\"===this.name},Event.prototype.serialize=function(){return JSON.stringify([this.name,this.attributes()])},Event.prototype.attributes=function(){return{id:this.id,channel:this.channel,data:this.data,token:this.token}},Event.prototype.run_callbacks=function(success,result){return this.success=success,this.result=result,this.success===!0?\"function\"==typeof this.success_callback?this.success_callback(this.result):void 0:\"function\"==typeof this.failure_callback?this.failure_callback(this.result):void 0},Event}()}.call(this),function(){WebSocketRails.AbstractConnection=function(){function AbstractConnection(url,dispatcher){this.dispatcher=dispatcher,this.message_queue=[]}return AbstractConnection.prototype.close=function(){},AbstractConnection.prototype.trigger=function(event){return\"connected\"!==this.dispatcher.state?this.message_queue.push(event):this.send_event(event)},AbstractConnection.prototype.send_event=function(event){return null!=this.connection_id?event.connection_id=this.connection_id:void 0},AbstractConnection.prototype.on_close=function(event){var close_event;return this.dispatcher&&this.dispatcher._conn===this?(close_event=new WebSocketRails.Event([\"connection_closed\",event]),this.dispatcher.state=\"disconnected\",this.dispatcher.dispatch(close_event)):void 0},AbstractConnection.prototype.on_error=function(event){var error_event;return this.dispatcher&&this.dispatcher._conn===this?(error_event=new WebSocketRails.Event([\"connection_error\",event]),this.dispatcher.state=\"disconnected\",this.dispatcher.dispatch(error_event)):void 0},AbstractConnection.prototype.on_message=function(event_data){return this.dispatcher&&this.dispatcher._conn===this?this.dispatcher.new_message(event_data):void 0},AbstractConnection.prototype.setConnectionId=function(connection_id){this.connection_id=connection_id},AbstractConnection.prototype.flush_queue=function(){var event,_i,_len,_ref;for(_ref=this.message_queue,_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],this.trigger(event);return this.message_queue=[]},AbstractConnection}()}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};WebSocketRails.WebSocketConnection=function(_super){function WebSocketConnection(url,dispatcher){this.url=url,this.dispatcher=dispatcher,WebSocketConnection.__super__.constructor.apply(this,arguments),this.url.match(/^wss?:\\/\\//)?console.log(\"WARNING: Using connection urls with protocol specified is depricated\"):this.url=\"https:\"===window.location.protocol?\"wss://\"+this.url:\"ws://\"+this.url,this._conn=new WebSocket(this.url),this._conn.onmessage=function(_this){return function(event){var event_data;return event_data=JSON.parse(event.data),_this.on_message(event_data)}}(this),this._conn.onclose=function(_this){return function(event){return _this.on_close(event)}}(this),this._conn.onerror=function(_this){return function(event){return _this.on_error(event)}}(this)}return __extends(WebSocketConnection,_super),WebSocketConnection.prototype.connection_type=\"websocket\",WebSocketConnection.prototype.close=function(){return this._conn.close()},WebSocketConnection.prototype.send_event=function(event){return WebSocketConnection.__super__.send_event.apply(this,arguments),this._conn.send(event.serialize())},WebSocketConnection}(WebSocketRails.AbstractConnection)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};WebSocketRails.Channel=function(){function Channel(name,_dispatcher,is_private,on_success,on_failure){var event,event_name,_ref;this.name=name,this._dispatcher=_dispatcher,this.is_private=null!=is_private?is_private:!1,this.on_success=on_success,this.on_failure=on_failure,this._failure_launcher=__bind(this._failure_launcher,this),this._success_launcher=__bind(this._success_launcher,this),this._callbacks={},this._token=void 0,this._queue=[],event_name=this.is_private?\"websocket_rails.subscribe_private\":\"websocket_rails.subscribe\",this.connection_id=null!=(_ref=this._dispatcher._conn)?_ref.connection_id:void 0,event=new WebSocketRails.Event([event_name,{data:{channel:this.name}},this.connection_id],this._success_launcher,this._failure_launcher),this._dispatcher.trigger_event(event)}return Channel.prototype.destroy=function(){var event,event_name,_ref;return this.connection_id===(null!=(_ref=this._dispatcher._conn)?_ref.connection_id:void 0)&&(event_name=\"websocket_rails.unsubscribe\",event=new WebSocketRails.Event([event_name,{data:{channel:this.name}},this.connection_id]),this._dispatcher.trigger_event(event)),this._callbacks={}},Channel.prototype.bind=function(event_name,callback){var _base;return null==(_base=this._callbacks)[event_name]&&(_base[event_name]=[]),this._callbacks[event_name].push(callback)},Channel.prototype.unbind=function(event_name){return delete this._callbacks[event_name]},Channel.prototype.trigger=function(event_name,message){var event;return event=new WebSocketRails.Event([event_name,{channel:this.name,data:message,token:this._token},this.connection_id]),this._token?this._dispatcher.trigger_event(event):this._queue.push(event)},Channel.prototype.dispatch=function(event_name,message){var callback,_i,_len,_ref,_ref1,_results;if(\"websocket_rails.channel_token\"===event_name)return this.connection_id=null!=(_ref=this._dispatcher._conn)?_ref.connection_id:void 0,this._token=message.token,this.flush_queue();if(null!=this._callbacks[event_name]){for(_ref1=this._callbacks[event_name],_results=[],_i=0,_len=_ref1.length;_len>_i;_i++)callback=_ref1[_i],_results.push(callback(message));return _results}},Channel.prototype._success_launcher=function(data){return null!=this.on_success?this.on_success(data):void 0},Channel.prototype._failure_launcher=function(data){return null!=this.on_failure?this.on_failure(data):void 0},Channel.prototype.flush_queue=function(){var event,_i,_len,_ref;for(_ref=this._queue,_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],this._dispatcher.trigger_event(event);return this._queue=[]},Channel}()}.call(this);\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\n/*!\n * JavaScript Cookie v2.1.2\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if ((typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n})(function () {\n\tfunction extend() {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[i];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init(converter) {\n\t\tfunction api(key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\treturn document.cookie = [key, '=', value, attributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\n\t\t\t\tattributes.path && '; path=' + attributes.path, attributes.domain && '; domain=' + attributes.domain, attributes.secure ? '; secure' : ''].join('');\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ? converter.read(cookie, name) : converter(cookie, name) || cookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api(key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n});\n'use strict';\n\nfunction detectBrowser(userAgentString) {\n  var browsers = [['edge', /Edge\\/([0-9\\._]+)/], ['chrome', /(?!Chrom.*OPR)Chrom(?:e|ium)\\/([0-9\\.]+)(:?\\s|$)/], ['firefox', /Firefox\\/([0-9\\.]+)(?:\\s|$)/], ['opera', /Opera\\/([0-9\\.]+)(?:\\s|$)/], ['opera', /OPR\\/([0-9\\.]+)(:?\\s|$)$/], ['ie', /Trident\\/7\\.0.*rv\\:([0-9\\.]+)\\).*Gecko$/], ['ie', /MSIE\\s([0-9\\.]+);.*Trident\\/[4-7].0/], ['ie', /MSIE\\s(7\\.0)/], ['bb10', /BB10;\\sTouch.*Version\\/([0-9\\.]+)/], ['android', /Android\\s([0-9\\.]+)/], ['ios', /iPad.*Version\\/([0-9\\._]+)/], ['ios', /iPhone.*Version\\/([0-9\\._]+)/], ['safari', /Version\\/([0-9\\._]+).*Safari/]];\n\n  var i = 0,\n      mapped = [];\n  for (i = 0; i < browsers.length; i++) {\n    browsers[i] = createMatch(browsers[i]);\n    if (isMatch(browsers[i])) {\n      mapped.push(browsers[i]);\n    }\n  }\n\n  var match = mapped[0];\n  var parts = match && match[3].split(/[._]/).slice(0, 3);\n\n  while (parts && parts.length < 3) {\n    parts.push('0');\n  }\n\n  function createMatch(pair) {\n    return pair.concat(pair[1].exec(userAgentString));\n  }\n\n  function isMatch(pair) {\n    return !!pair[2];\n  }\n\n  // return the name and version\n  return {\n    name: match && match[0],\n    version: parts && parts.join('.')\n  };\n};\n\"use strict\";\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n\n  Kaanjo.socket.on_open = function (data) {\n    console.log(\"Connection established: \" + data.connection_id);\n    setTimeout(function () {\n      Kaanjo.init();\n    }, 500);\n  };\n});\n\nvar Kaanjo = {\n  init: function init() {\n\n    Kaanjo.hook = document.getElementById(\"kaanjo\");\n\n    if (!Kaanjo.valid(Kaanjo.hook)) return false;\n\n    for (var attribute in Kaanjo.attributes) {\n      Kaanjo.attributes[attribute] = Kaanjo.hook.getAttribute(\"data-\" + attribute);\n    }\n\n    Kaanjo.webmaster.init(function () {\n      Kaanjo.customer.init(function () {\n        Kaanjo.product.init(function () {\n          Kaanjo.request('customer.impress', {\n            device: detectBrowser(navigator.userAgent).name\n          }, function (success) {\n            console.log(success.msg);\n            Kaanjo.get_html();\n          });\n        });\n      });\n    });\n  },\n\n\n  webmaster: {\n    init: function init(cb) {\n      Kaanjo.request('webmaster.find', {\n        key: Kaanjo.attributes['key']\n      }, function (success) {\n        console.log(success.msg);\n        cb();\n      }, function (fail) {\n        console.log(fail.msg);\n      });\n    }\n  },\n\n  customer: {\n    init: function init(cb) {\n\n      params = { id: null };\n\n      Kaanjo.customer.id = Kaanjo.cookies.get('kaanjo_cid');\n      if (Kaanjo.customer.id) {\n        params.id = Kaanjo.customer.id;\n      }\n\n      Kaanjo.request('customer.find', params, function (success) {\n        Kaanjo.cookies.set('kaanjo_cid', success.sid);\n        Kaanjo.customer.id = success.sid;\n        console.log(success.msg);\n        cb();\n      }, function (fail) {\n        console.log(fail.msg);\n      });\n    }\n  },\n\n  product: {\n    init: function init(cb) {\n      Kaanjo.request('product.find', {\n        product: Kaanjo.attributes.product,\n        url: window.location.href\n      }, function (success) {\n        Kaanjo.product.data = success.data;\n        console.log(success.msg);\n        cb();\n      }, function (fail) {\n        console.log(fail.msg);\n      });\n    }\n  },\n\n  get_html: function get_html() {\n    Kaanjo.request('product.get_html', {}, function (html) {\n      Kaanjo.hook.innerHTML = html.msg;\n    });\n  },\n\n\n  cookies: Cookies.noConflict(),\n\n  //socket: new WebSocketRails('localhost:3000/websocket'),\n  socket: new WebSocketRails('kaanjo.co/websocket'),\n\n  request: function request(action, data, success, fail) {\n    Kaanjo.socket.trigger(action, data, success, fail);\n  },\n  react: function react(reaction_id) {\n    Kaanjo.request('customer.react', {\n      id: reaction_id\n    });\n  },\n  valid: function valid(hook) {\n\n    var is_valid = true;\n\n    if (hook == null) {\n      is_valid = false;\n    } else {\n\n      for (var attribute in Kaanjo.attributes) {\n\n        if (!hook.hasAttribute(\"data-\" + attribute)) {\n          console.error(\"Kaanjo: You are missing the '\" + attribute + \"' attribute in your HTML.\");\n          is_valid = false;\n        }\n      }\n    }\n\n    return is_valid;\n  },\n\n\n  attributes: {\n    key: null,\n    product: null\n  }\n\n};\n\nfunction cl(msg) {\n  console.log(msg);\n}","/*!\n * JavaScript Cookie v2.1.2\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\treturn (document.cookie = [\n\t\t\t\t\tkey, '=', value,\n\t\t\t\t\tattributes.expires && '; expires=' + attributes.expires.toUTCString(), // use expires attribute, max-age is not supported by IE\n\t\t\t\t\tattributes.path    && '; path=' + attributes.path,\n\t\t\t\t\tattributes.domain  && '; domain=' + attributes.domain,\n\t\t\t\t\tattributes.secure ? '; secure' : ''\n\t\t\t\t].join(''));\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api(key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n"],"sourceRoot":"/source/"}